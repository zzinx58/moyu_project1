import{n as pe,u as me,_ as be,a as ge}from"./SelectMenu.d9f3361b.js";import{_ as G}from"./Button.76eacea6.js";import{_ as ye}from"./nuxt-link.65fe6b0a.js";import{_ as Q,f as W,m as S,n as I,q as B,s as D,v as ve,o as p,c as v,a as C,l as he,ap as ke,E as R,x as z,d as _,t as P,y as k,K as w,r as T,b as j,F as L,z as Y,J as N,W as Ce,A as q,I as $e,w as U,i as F,j as x,aq as ee}from"./entry.ebd3bb8a.js";import{t as ae,k as Se,c as oe,b as te,d as J,e as K,g as Be,h as Ve,_ as Ae}from"./Link.7fab82c8.js";import{b as we,o as Me}from"./omit.a19d229c.js";import{i as Ue}from"./Avatar.8b1122f4.js";import{u as ne}from"./fetch.0affcee4.js";import{d as E}from"./dayjs.min.dc50587d.js";import{u as je,t as Oe}from"./utc.5c4aeaac.js";import"./index.948e5a5f.js";function Fe(e,t,n){var u=e.length;return n=n===void 0?u:n,!t&&n>=u?e:we(e,t,n)}var _e="\\ud800-\\udfff",Pe="\\u0300-\\u036f",ze="\\ufe20-\\ufe2f",Ne="\\u20d0-\\u20ff",Ee=Pe+ze+Ne,Te="\\ufe0e\\ufe0f",De="\\u200d",Re=RegExp("["+De+_e+Ee+Te+"]");function le(e){return Re.test(e)}function qe(e){return e.split("")}var ue="\\ud800-\\udfff",Le="\\u0300-\\u036f",Ye="\\ufe20-\\ufe2f",Ge="\\u20d0-\\u20ff",We=Le+Ye+Ge,Je="\\ufe0e\\ufe0f",He="["+ue+"]",Z="["+We+"]",X="\\ud83c[\\udffb-\\udfff]",Ke="(?:"+Z+"|"+X+")",ie="[^"+ue+"]",re="(?:\\ud83c[\\udde6-\\uddff]){2}",se="[\\ud800-\\udbff][\\udc00-\\udfff]",Ze="\\u200d",de=Ke+"?",ce="["+Je+"]?",Xe="(?:"+Ze+"(?:"+[ie,re,se].join("|")+")"+ce+de+")*",Qe=ce+de+Xe,Ie="(?:"+[ie+Z+"?",Z,re,se,He].join("|")+")",xe=RegExp(X+"(?="+X+")|"+Ie+Qe,"g");function et(e){return e.match(xe)||[]}function tt(e){return le(e)?et(e):qe(e)}function nt(e){return function(t){t=ae(t);var n=le(t)?tt(t):void 0,u=n?n[0]:t.charAt(0),i=n?Fe(n,1).join(""):t.slice(1);return u[e]()+i}}var at=nt("toUpperCase");const ot=at;function lt(e){return ot(ae(e).toLowerCase())}function ut(e){return function(t,n,u){for(var i=-1,a=Object(t),o=u(t),f=o.length;f--;){var r=o[e?f:++i];if(n(a[r],r,a)===!1)break}return t}}var it=ut();const rt=it;function st(e,t){return e&&rt(e,t,Se)}function dt(e,t){return function(n,u){if(n==null)return n;if(!oe(n))return e(n,u);for(var i=n.length,a=t?i:-1,o=Object(n);(t?a--:++a<i)&&u(o[a],a,o)!==!1;);return n}}var ct=dt(st);const ft=ct;function pt(e,t){var n=-1,u=oe(e)?Array(e.length):[];return ft(e,function(i,a,o){u[++n]=t(i,a,o)}),u}function mt(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}function bt(e,t){if(e!==t){var n=e!==void 0,u=e===null,i=e===e,a=te(e),o=t!==void 0,f=t===null,r=t===t,d=te(t);if(!f&&!d&&!a&&e>t||a&&o&&r&&!f&&!d||u&&o&&r||!n&&r||!i)return 1;if(!u&&!a&&!d&&e<t||d&&n&&i&&!u&&!a||f&&n&&i||!o&&i||!r)return-1}return 0}function gt(e,t,n){for(var u=-1,i=e.criteria,a=t.criteria,o=i.length,f=n.length;++u<o;){var r=bt(i[u],a[u]);if(r){if(u>=f)return r;var d=n[u];return r*(d=="desc"?-1:1)}}return e.index-t.index}function yt(e,t,n){t.length?t=J(t,function(a){return K(a)?function(o){return Be(o,a.length===1?a[0]:a)}:a}):t=[Ue];var u=-1;t=J(t,Ve(pe));var i=pt(e,function(a,o,f){var r=J(t,function(d){return d(a)});return{criteria:r,index:++u,value:a}});return mt(i,function(a,o){return gt(a,o,n)})}function vt(e,t,n,u){return e==null?[]:(K(t)||(t=t==null?[]:[t]),n=u?void 0:n,K(n)||(n=n==null?[]:[n]),yt(e,t,n))}const ht=W({inheritAttrs:!1,props:{value:{type:[String,Number,Boolean,Object],default:null},modelValue:{type:[Boolean,Array],default:null},name:{type:String,default:null},disabled:{type:Boolean,default:!1},checked:{type:Boolean,default:!1},indeterminate:{type:Boolean,default:!1},help:{type:String,default:null},label:{type:String,default:null},required:{type:Boolean,default:!1},color:{type:String,default:()=>S.ui.checkbox.default.color,validator(e){return S.ui.colors.includes(e)}},ui:{type:Object,default:()=>S.ui.checkbox}},emits:["update:modelValue","change"],setup(e,{emit:t}){const n=I(),u=B(()=>D({},e.ui,n.ui.checkbox)),{emitFormBlur:i}=me(),a=B({get(){return e.modelValue},set(r){t("update:modelValue",r)}}),o=r=>{t("change",r),i()},f=B(()=>ve(u.value.base,u.value.rounded,u.value.background,u.value.border,u.value.ring.replaceAll("{color}",e.color),u.value.color.replaceAll("{color}",e.color)));return{ui:u,toggle:a,inputClass:f,onChange:o}}}),kt={class:"flex items-center h-5"},Ct=["id","name","required","value","disabled","checked","indeterminate"],$t={key:0,class:"ms-3 text-sm"},St=["for"];function Bt(e,t,n,u,i,a){return p(),v("div",{class:k(e.ui.wrapper)},[C("div",kt,[he(C("input",R({id:e.name,"onUpdate:modelValue":t[0]||(t[0]=o=>e.toggle=o),name:e.name,required:e.required,value:e.value,disabled:e.disabled,checked:e.checked,indeterminate:e.indeterminate,type:"checkbox",class:["form-checkbox",e.inputClass]},e.$attrs,{onChange:t[1]||(t[1]=(...o)=>e.onChange&&e.onChange(...o))}),null,16,Ct),[[ke,e.toggle]])]),e.label||e.$slots.label?(p(),v("div",$t,[C("label",{for:e.name,class:k(e.ui.label)},[z(e.$slots,"label",{},()=>[_(P(e.label),1)]),e.required?(p(),v("span",{key:0,class:k(e.ui.required)},"*",2)):w("",!0)],10,St),e.help?(p(),v("p",{key:0,class:k(e.ui.help)},P(e.help),3)):w("",!0)])):w("",!0)],2)}const Vt=Q(ht,[["render",Bt]]);function At(e,t){return e===t}const wt=W({props:{modelValue:{type:Array,default:null},by:{type:[String,Function],default:()=>At},rows:{type:Array,default:()=>[]},columns:{type:Array,default:null},columnAttribute:{type:String,default:"label"},sort:{type:Object,default:()=>({})},sortButton:{type:Object,default:()=>S.ui.table.default.sortButton},sortAscIcon:{type:String,default:()=>S.ui.table.default.sortAscIcon},sortDescIcon:{type:String,default:()=>S.ui.table.default.sortDescIcon},loading:{type:Boolean,default:!1},loadingState:{type:Object,default:()=>S.ui.table.default.loadingState},emptyState:{type:Object,default:()=>S.ui.table.default.emptyState},ui:{type:Object,default:()=>S.ui.table}},emits:["update:modelValue"],setup(e,{emit:t,attrs:n}){const u=I(),i=B(()=>D({},e.ui,u.ui.table)),a=B(()=>e.columns??Object.keys(Me(e.rows[0]??{},["click"])).map(l=>({key:l,label:lt(l),sortable:!1}))),o=T(D({},e.sort,{column:null,direction:"asc"})),f=B(()=>{var s;if(!((s=o.value)!=null&&s.column))return e.rows;const{column:l,direction:y}=o.value;return vt(e.rows,l,y)}),r=B({get(){return e.modelValue},set(l){t("update:modelValue",l)}}),d=B(()=>r.value&&r.value.length>0&&r.value.length<e.rows.length),V=B(()=>({...i.value.default.emptyState,...e.emptyState}));function $(l,y){if(typeof e.by=="string"){const s=e.by;return(l==null?void 0:l[s])===(y==null?void 0:y[s])}return e.by(l,y)}function b(l){return e.modelValue?r.value.some(y=>$(q(y),q(l))):!1}function A(l){if(o.value.column===l.key){const y=!l.direction||l.direction==="asc"?"desc":"asc";o.value.direction===y?o.value=D({},e.sort,{column:null,direction:"asc"}):o.value.direction=o.value.direction==="asc"?"desc":"asc"}else o.value={column:l.key,direction:l.direction||"asc"}}function c(l){n.onSelect&&n.onSelect(l)}function g(){e.rows.forEach(l=>{r.value.some(y=>$(q(y),q(l)))||c(l)})}function m(l){l.target.checked?g():r.value=[]}return{ui:i,sort:o,columns:a,rows:f,selected:r,indeterminate:d,emptyState:V,isSelected:b,onSort:A,onSelect:c,onChange:m}}}),Mt={key:0,scope:"col",class:"ps-4"},Ut={key:1},jt={key:0},Ot=["colspan"],Ft={key:1},_t=["colspan"],Pt=["onClick"],zt={key:0,class:"ps-4"};function Nt(e,t,n,u,i,a){const o=Vt,f=G,r=Ae;return p(),v("div",{class:k(e.ui.wrapper)},[C("table",{class:k([e.ui.base,e.ui.divide])},[C("thead",{class:k(e.ui.thead)},[C("tr",{class:k(e.ui.tr.base)},[e.modelValue?(p(),v("th",Mt,[j(o,{checked:e.indeterminate||e.selected.length===e.rows.length,indeterminate:e.indeterminate,onChange:e.onChange},null,8,["checked","indeterminate","onChange"])])):w("",!0),(p(!0),v(L,null,Y(e.columns,(d,V)=>(p(),v("th",{key:V,scope:"col",class:k([e.ui.th.base,e.ui.th.padding,e.ui.th.color,e.ui.th.font,e.ui.th.size,d.class])},[z(e.$slots,`${d.key}-header`,{column:d,sort:e.sort,onSort:e.onSort},()=>[d.sortable?(p(),N(f,R({key:0},{...e.ui.default.sortButton,...e.sortButton},{icon:!e.sort.column||e.sort.column!==d.key?e.sortButton.icon||e.ui.default.sortButton.icon:e.sort.direction==="asc"?e.sortAscIcon:e.sortDescIcon,label:d[e.columnAttribute],onClick:$=>e.onSort(d)}),null,16,["icon","label","onClick"])):(p(),v("span",Ut,P(d[e.columnAttribute]),1))])],2))),128))],2)],2),C("tbody",{class:k(e.ui.tbody)},[e.loadingState&&e.loading?(p(),v("tr",jt,[C("td",{colspan:e.columns.length+(e.modelValue?1:0)},[z(e.$slots,"loading-state",{},()=>[C("div",{class:k(e.ui.loadingState.wrapper)},[e.loadingState.icon?(p(),N(r,{key:0,name:e.loadingState.icon,class:k(e.ui.loadingState.icon),"aria-hidden":"true"},null,8,["name","class"])):w("",!0),C("p",{class:k(e.ui.loadingState.label)},P(e.loadingState.label),3)],2)])],8,Ot)])):e.emptyState&&!e.rows.length?(p(),v("tr",Ft,[C("td",{colspan:e.columns.length+(e.modelValue?1:0)},[z(e.$slots,"empty-state",{},()=>[C("div",{class:k(e.ui.emptyState.wrapper)},[e.emptyState.icon?(p(),N(r,{key:0,name:e.emptyState.icon,class:k(e.ui.emptyState.icon),"aria-hidden":"true"},null,8,["name","class"])):w("",!0),C("p",{class:k(e.ui.emptyState.label)},P(e.emptyState.label),3)],2)])],8,_t)])):(p(!0),v(L,{key:2},Y(e.rows,(d,V)=>(p(),v("tr",{key:V,class:k([e.ui.tr.base,e.isSelected(d)&&e.ui.tr.selected,e.$attrs.onSelect&&e.ui.tr.active]),onClick:()=>e.onSelect(d)},[e.modelValue?(p(),v("td",zt,[j(o,{modelValue:e.selected,"onUpdate:modelValue":t[0]||(t[0]=$=>e.selected=$),value:d,onClick:t[1]||(t[1]=Ce(()=>{},["stop"]))},null,8,["modelValue","value"])])):w("",!0),(p(!0),v(L,null,Y(e.columns,($,b)=>(p(),v("td",{key:b,class:k([e.ui.td.base,e.ui.td.padding,e.ui.td.color,e.ui.td.font,e.ui.td.size])},[z(e.$slots,`${$.key}-data`,{column:$,row:d,index:V},()=>[_(P(d[$.key]),1)])],2))),128))],10,Pt))),128))],2)],2)],2)}const Et=Q(wt,[["render",Nt]]),Tt=W({components:{UButton:G},props:{modelValue:{type:Number,required:!0},pageCount:{type:Number,default:10},total:{type:Number,required:!0},max:{type:Number,default:7,validate(e){return e>=7&&e<Number.MAX_VALUE}},size:{type:String,default:()=>S.ui.pagination.default.size,validator(e){return Object.keys(S.ui.button.size).includes(e)}},activeButton:{type:Object,default:()=>S.ui.pagination.default.activeButton},inactiveButton:{type:Object,default:()=>S.ui.pagination.default.inactiveButton},prevButton:{type:Object,default:()=>S.ui.pagination.default.prevButton},nextButton:{type:Object,default:()=>S.ui.pagination.default.nextButton},divider:{type:String,default:"…"},ui:{type:Object,default:()=>S.ui.pagination}},emits:["update:modelValue"],setup(e,{emit:t}){const n=I(),u=B(()=>D({},e.ui,n.ui.pagination)),i=B({get(){return e.modelValue},set(b){t("update:modelValue",b)}}),a=B(()=>Array.from({length:Math.ceil(e.total/e.pageCount)},(b,A)=>A+1)),o=B(()=>{if(!e.max||a.value.length<=5)return a.value;{const b=i.value,A=a.value.length,c=Math.floor((Math.min(e.max,A)-5)/2),g=b-c,m=b+c,l=g-1>1,y=m+1<A,s=[1];if(l&&s.push(e.divider),!y){const M=b+c+2-A;for(let O=b-c-M;O<=b-c-1;O++)s.push(O)}for(let M=g>2?g:2;M<=Math.min(A,m);M++)s.push(M);if(!l){const M=1-(b-c-2);for(let O=b+c+1;O<=b+c+M;O++)s.push(O)}return y&&s.push(e.divider),m<A&&s.push(A),s.length>=3&&s[1]===e.divider&&s[2]===3&&(s[1]=2),s.length>=3&&s[s.length-2]===e.divider&&s[s.length-1]===s.length&&(s[s.length-2]=s.length-1),s}}),f=B(()=>i.value>1),r=B(()=>i.value<a.value.length);function d(b){typeof b!="string"&&(i.value=b)}function V(){f.value&&i.value--}function $(){r.value&&i.value++}return{ui:u,currentPage:i,pages:a,displayedPages:o,canGoPrev:f,canGoNext:r,onClickPrev:V,onClickNext:$,onClickPage:d}}});function Dt(e,t,n,u,i,a){const o=G;return p(),v("div",{class:k(e.ui.wrapper)},[z(e.$slots,"prev",{onClick:e.onClickPrev},()=>[e.prevButton?(p(),N(o,R({key:0,size:e.size,disabled:!e.canGoPrev,class:[e.ui.base,e.ui.rounded]},{...e.ui.default.prevButton,...e.prevButton},{ui:{rounded:""},onClick:e.onClickPrev}),null,16,["size","disabled","class","onClick"])):w("",!0)]),(p(!0),v(L,null,Y(e.displayedPages,(f,r)=>(p(),N(o,R({key:r,size:e.size,label:`${f}`},f===e.currentPage?{...e.ui.default.activeButton,...e.activeButton}:{...e.ui.default.inactiveButton,...e.inactiveButton},{class:[{"pointer-events-none":typeof f=="string","z-[1]":f===e.currentPage},e.ui.base,e.ui.rounded],ui:{rounded:""},onClick:()=>e.onClickPage(f)}),null,16,["size","label","class","onClick"]))),128)),z(e.$slots,"next",{onClick:e.onClickNext},()=>[e.nextButton?(p(),N(o,R({key:0,size:e.size,disabled:!e.canGoNext,class:[e.ui.base,e.ui.rounded]},{...e.ui.default.nextButton,...e.nextButton},{ui:{rounded:""},onClick:e.onClickNext}),null,16,["size","disabled","class","onClick"])):w("",!0)])],2)}const Rt=Q(Tt,[["render",Dt]]),qt={class:"flex justify-between mb-6 items-center"},Lt={class:"h-[calc(60px*11)]"},Yt={class:"space-x-5"},Gt={key:0},Wt={key:1},Jt={key:2},Ht={class:"flex justify-center mt-50px"},H=10,ln=W({__name:"t_list",setup(e){E.extend(je),E.extend(Oe);const t={},n={base:"w-261px h-36px",option:{color:"bg-red"}},u={label:{base:"mr-4 text-16px"},container:"mt-0"},i={tbody:"h-[calc(60px*10)]",divide:"",th:{color:"text-white bg-primary_2 ",base:"text-center  first:rounded-l-10px last:rounded-r-10px"},td:{base:"text-center  first:rounded-l-10px last:rounded-r-10px py-3"},tr:{base:"even:bg-#EDF1FE h-60px"},base:"min-w-full table-fixed"},a=[{id:1,label:"报名未开始",color:"#F19EC2"},{id:2,label:"报名中",color:"##88ABDA"},{id:3,label:"报名已结束 比赛未开始",color:"##89C997"},{id:4,label:"比赛中",color:"##F29B76"},{id:5,label:"比赛已结束 未公示",color:"##8F82BC"},{id:6,label:"比赛已结束 公示中",color:"##535353"}],o=[{label:"#",key:"id"},{label:"比赛名称",key:"sub_name"},{label:"日期",key:"time_range"},{label:"状态",key:"status"},{label:"操作",key:"actions"},{label:"审核",key:"audit_status"}];function f(c){return c!==null&&Array.prototype.includes.call(c,"")}const r=(c,g,m)=>{const l=c().unix();if(console.log(f(m)),f(m)&&f(g))switch(!0){case l<+g[0]:return a[0];case(l>+g[0]&&l<+g[1]):return a[1];case(l>+g[1]&&l<+m[0]):return a[2];case(l>+m[0]&&l<+m[1]):return a[3];case l>+m[1]:return{id:4,label:"公示需求错误",color:"#000000"}}return!1};let d=T(0);const V=T();$e(async()=>{const{data:c}=await ne("/api/t_list/t_getAll","$WMJqSVypyK");if(c.value||alert("数据获取失败"),c.value){const g=c.value.map(m=>{const l=r(E,m.apply_time_range,m.time_range);return{id:m.id,time_range:m.time_range,apply_time_range:m.apply_time_range,sub_name:m.sub_name,audit_status:m.audit_status,status:l}});V.value=g,d.value=V.value.length}}),T([]);const $=T(1),b=B(()=>{var c;return(c=V.value)==null?void 0:c.slice(($.value-1)*H,$.value*H)});console.log("finalListData",b.value);const A=async c=>{var l,y;const g=c.id,{data:m}=await ne("/api/t_list/t_delete",{method:"POST",body:{id:g}},"$y2kfjfVgdM");if(m.value){const s=(l=V.value)==null?void 0:l.findIndex(M=>M.id===g);s&&((y=V.value)==null||y.splice(s,1))}return m.value};return(c,g)=>{const m=ge,l=be,y=G,s=ye,M=Et,O=Rt;return p(),v("div",null,[C("div",qt,[j(l,{label:"比赛状态",class:"flex",ui:u},{default:U(()=>[j(m,{modelValue:F(b),"onUpdate:modelValue":g[0]||(g[0]=h=>x(b)?b.value=h:null),options:a,"option-attribute":"label","value-attribute":"id",placeholder:"全部",multiple:"","ui-menu":t,ui:n},null,8,["modelValue"])]),_:1}),j(y,{class:"bg-primary_1 hover:bg-primary_1 active:opacity-80 rounded-24px w-120px h-48px flex justify-center",ui:{size:{sm:"text-20px"}},onClick:g[1]||(g[1]=h=>("navigateTo"in c?c.navigateTo:F(ee))("/t_info"))},{default:U(()=>[_("创建赛事")]),_:1})]),C("div",Lt,[j(M,{columns:o,"column-attribute":"label",rows:F(b),ui:i},{"sub_name-data":U(({row:h})=>[j(s,{to:`/t_info/${h.id}`,class:"underline text-#315EFB"},{default:U(()=>[_(P(h.sub_name),1)]),_:2},1032,["to"])]),"time_range-data":U(({row:h})=>[C("span",null,P(`${h.time_range===null?"日期为 Null":Array.prototype.includes.call(h.time_range,"")?"日期错误，日期数组中有空元素":`${F(E).unix(+h.time_range[0]).utc(!0).format("YYYY.MM.DD").toString()} - ${F(E).unix(+h.time_range[1]).utc(!0).format("YYYY.MM.DD").toString()}`}`),1)]),"status-data":U(({row:h})=>[_(" 123 ")]),"actions-data":U(({row:h})=>[C("div",Yt,[j(y,{icon:"i-mdi-edit",trailing:!0,class:"bg-primary_1 hover:bg-primary_1 hover:opacity-80",onClick:fe=>("navigateTo"in c?c.navigateTo:F(ee))(`/t_info/${h.id}`)},{default:U(()=>[_("编辑")]),_:2},1032,["onClick"]),j(y,{icon:"i-mdi-delete",trailing:!0,class:"bg-primary_2 hover:bg-primary_2 hover:opacity-80",onClick:fe=>A(h)},{default:U(()=>[_("删除")]),_:2},1032,["onClick"])])]),"audit_status-data":U(({row:h})=>[+h.audit_status==0?(p(),v("span",Gt,"审核不通过")):w("",!0),+h.audit_status==1?(p(),v("span",Wt,"审核通过")):w("",!0),+h.audit_status==2?(p(),v("span",Jt,[j(y,{type:"button",class:"bg-primary_1"},{default:U(()=>[_("审核")]),_:1})])):w("",!0)]),_:1},8,["rows"])]),C("div",Ht,[j(O,{"page-count":H,total:F(d),modelValue:F($),"onUpdate:modelValue":g[2]||(g[2]=h=>x($)?$.value=h:null),"prev-button":{label:"上一页",variant:"ghost",color:"orange"},"next-button":{label:"下一页",trailing:!0,variant:"ghost",color:"orange"},ui:{base:"min-w-[40px] h-40px active:bg-primary_1 active:text-white",rounded:"rounded-10px justify-center"},"inactive-button":{variant:"ghost",color:"orange"},"active-button":{variant:"solid",color:"orange"}},null,8,["total","modelValue"])])])}}});export{ln as default};
